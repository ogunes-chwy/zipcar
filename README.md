# Zip-Car
- confluence doc design: https://chewyinc.atlassian.net/wiki/x/6A9p4w
- confluence doc how to run: https://chewyinc.atlassian.net/wiki/x/RQA_-/ 

<img width="1385" height="818" alt="image" src="https://github.com/user-attachments/assets/4a4d3da3-ce2e-43ba-91b3-a67852cbee92" />

**How To Run ZipCar for Carrier-Zip Recommendations**

currently, default setting in configs.yaml:
- running simulation for baseline & remediation
- running zip recommendation for remediation only

running instructions:
1. update `user` and `password` in `connection_settings` in `snowflake_utils.py` to your credentials. make sure you have SC_PROMISE_DEVELOPER_MARGIN role in SnowFlake.
    - `‘user': os.getenv(’USER')` 
    - `'password': os.getenv(’USER')`
2. `python run_simulation.py`
    - Generates simulation for baseline / remediation / expansion for trailing look back day count.
   it prompts you to AWS login.
4. `python get_execution_rules_data.py`
    - Gets unpadded dea / backlog / shutdown for trailing look back day count.
7. `python execution_zip_recommendation.py`
    - Recommend zips to remediate / expand and generates cost saving / ontrgd coverage / fc charge change estimations based on simulation.

Folders:
- `data`: Stores simulation / smf / execution data generated by run_simulation.py and get_execution_rules_data.py. this is input to execution_zip_recommendation.py.
- `sql`: sql scripts called by run_simulation.py and get_execution_rules_data.py
- `results`: 
    - `zips_to_remediate`: recommended zips to remediate daily. if file name ends with 99999, it means it includes all zip recommendations to remediate. otherwise, it includes X amount of zip codes to remediate.
    - `zips_to_expand`: recommended zips to expand daily. if file name ends with 99999, it means it includes all zip recommendations to expand. otherwise, it includes X amount of zip codes to expand.
    - `simulation_output`: simulation output by package with recommended remediate & expand changes.
    - `metrics`: ontrgd coverage change / fc charge change
    - `metadata`: metadata which includes all fields that is used for recommendation 
    
**How To Run Simulation with Different Carrier Network**

There is an option to run Nostra simulation with different carrier network than other 3 defined above. In order to do that:
1. Update smf_custom.sql file accordingly. The output schema should stay same.
2. Change `simulation_scenario` in `configs.yaml` to such `simulation_scenario: ['custom_smf']`
3. python run_simulation.py
4. you will see simulation output in data/simulations/{simulation_scenario} and corresponding SMF in data/smf/{simulation_scenario}

